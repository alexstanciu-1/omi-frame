
function importSupplierData(c,b){var a=$ctrl(jQuery(".qc-grid-properties"));a.setupLoader();omi.api("Omi\\App::ImportSupplierData",[c,b],function(d){a.unsetLoader();window.location.href=window.location.href},function(e){a.unsetLoader();var f=(e&&e.responseText)?e.responseText:null;var d=JSON.parse(f);var g=(d&&d.EXCEPTION)?d.EXCEPTION:null;alert(g?g.Message:f)})}function uniqid(){var a=new Date;var c=a.getTime();var b=1+Math.floor((Math.random()*32767));var d=1+Math.floor((Math.random()*32767));var e=c+"-"+b+"-"+d;return e}function setupQcTree(){jQuery(document.body).on("click",".qc-tree-trigger",function(a){var c=jQuery(this);var b=c.closest(".qc-qtree-item");if(c.hasClass("qc-collapsed")){c.addClass("qc-expanded fa-minus").removeClass("qc-collapsed fa-plus");b.next(".qc-qtree-children").slideDown()}else{c.addClass("qc-collapsed fa-plus").removeClass("qc-expanded fa-minus");b.next(".qc-qtree-children").slideUp()}})}function filterAddress(e,f,i){if(e==="selected"){var a=i.control;var k=a.$(".qc-dd-from").val();if(k==="Countries"){var d=this.$(".qc-dd-from[value='Counties']").closest(".qc-dd");var h=this.$(".qc-dd-from[value='Cities']").closest(".qc-dd");$ctrl(d).unsetSelected();$ctrl(h).unsetSelected()}else{if(k==="Counties"){var h=this.$(".qc-dd-from[value='Cities']").closest(".qc-dd");$ctrl(h).unsetSelected()}}}else{if(e==="beforePopupAdd"){var g=jQuery(i.sender);var c=g.closest(".qc-with-ctrl-dd").find(".qc-dd");var k=c.find(".qc-dd-from").val();if(k==="Counties"){var l=this.$(".qc-dd-from[value='Countries']").closest(".qc-dd");if(!$ctrl(l).getSelectedId()){alert("You must select country first!");i.control.stopPopupAdd=true}}else{if(k==="Cities"){var l=this.$(".qc-dd-from[value='Countries']").closest(".qc-dd");var d=this.$(".qc-dd-from[value='Counties']").closest(".qc-dd");if(!$ctrl(l).getSelectedId()||!$ctrl(d).getSelectedId()){alert("You must select country and county first!");i.control.stopPopupAdd=true}}}}else{if(e==="afterPopupAdd"){var g=jQuery(i.sender);var c=g.closest(".qc-with-ctrl-dd").find(".qc-dd");var k=c.find(".qc-dd-from").val();var b=i.popup;if(k==="Counties"){var l=this.$(".qc-dd-from[value='Countries']").closest(".qc-dd");b.find(".qc-country").val($ctrl(l).getSelectedId())}else{if(k==="Cities"){var l=this.$(".qc-dd-from[value='Countries']").closest(".qc-dd");var d=this.$(".qc-dd-from[value='Counties']").closest(".qc-dd");b.find(".qc-country").val($ctrl(l).getSelectedId());b.find(".qc-county").val($ctrl(d).getSelectedId())}}}else{if(e==="beforeUpdateResults"){var a=i.control;var k=a.$(".qc-dd-from").val();if(k==="Cities"){var l=this.$(".qc-dd-from[value='Countries']").closest(".qc-dd");var d=this.$(".qc-dd-from[value='Counties']").closest(".qc-dd");var j=$ctrl(l).getSelectedId();var m=$ctrl(d).getSelectedId();a.setBinds({Country:j?j:0,County:m?m:0})}else{if(k==="Counties"){var l=this.$(".qc-dd-from[value='Countries']").closest(".qc-dd");var j=$ctrl(l).getSelectedId();a.setBinds({Country:j?j:0})}}}}}}}function initPricing(){var c=jQuery(".qc-margin");for(var b=0;b<c.length;b++){c[b]._prvValue=jQuery(c[b]).val()}var a=jQuery(".qc-price");for(var b=0;b<a.length;b++){a[b]._prvValue=jQuery(a[b]).val()}jQuery(document.body).on("blur",".qc-margin",function(f){var g=jQuery(this);var d=$.trim(g.val());if(!is_numeric(d)){alert("The value is not accepted!");g.val(number_format(this._prvValue,2));return}this._prvValue=d;g.val(number_format(d,2));updatePricing(f)});jQuery(document.body).on("blur",".qc-price",function(f){var g=jQuery(this);var d=$.trim(g.val());if(!is_numeric(d)){alert("The value is not accepted!");g.val(number_format(this._prvValue,2));return}this._prvValue=d;g.val(number_format(d,2));updatePricing(f)});jQuery(document.body).on("onMouseHold",".qc-mhold-target",function(d){jQuery(this).hasClass("qc-general-margin")?updateMargins(d):updatePricing(d)})}function getCalculatedPrice(a,b){return parseFloat(a/(1-(b/100)))}function getCalculatedMargin(a,c){var b=(c&&a)?parseFloat((parseFloat(c)-parseFloat(a))/c)*100:0;if(b<0){b=0}return b}function updateMargins(c){var b=$ctrl(jQuery(".qc-xg-item"));var q=b.getSettings();var r=(q&&q.settings)?q.settings["CategoriesAccess"]:null;var e=jQuery(c.target);var o=jQuery(".qc-margin[data-interval='"+e.data("interval")+"']").not(e);var g=e.closest(".qc-category-margin-row");var d=[];if(g.length>0){var s=g.data("category");var n=r[s];for(var l=0;l<o.length;l++){var a=jQuery(o[l]);var p=a.closest(".qc-category-margin-row");var m=[];if(p.length===0){var j=a.closest(".qc-offer-price-row");m=j.data("categories")}else{m.push(p.data("category"))}var h=false;for(var f in m){if(n[m[f]]){h=true;break}}if(h){d.push(a)}}}else{d=o}for(var l=0;l<d.length;l++){var a=jQuery(d[l]);a.val(number_format(e.val(),2));a.trigger("blur")}}function updatePricing(b){var c=jQuery(b.target);var h=c.hasClass("qc-margin");var f=c.closest(".qc-pricing");var a=h?c:f.find(".qc-margin");var i=!h?c:f.find(".qc-price");var d=a.data("bp");if(h){var g=getCalculatedPrice(d,a.val());i.val(number_format(g,2))}else{var e=getCalculatedMargin(d,i.val());a.val(number_format(e,2))}}function setMarginsActions(){jQuery(".qc-mhold-up").mousehold(function(f){var i=jQuery(this);var b=i.closest(".qc-mhold-block");var d=b.find(".qc-mhold-target");var a=d.data("max-first-val");var h=d.data("max-val");var g=d.data("pace");if(!g){g=1}else{g=parseFloat(g)}var c=d.val();if(c!==undefined){c=parseFloat(c);c+=g;if((h!==undefined)&&(c>h)){c=h}}else{c=(a!==undefined)?a:0}c=number_format(c,2);d.val(c);d.trigger("onMouseHold",[f,c])});jQuery(".qc-mhold-down").mousehold(function(g){var i=jQuery(this);var c=i.closest(".qc-mhold-block");var f=c.find(".qc-mhold-target");var b=f.data("min-first-val");var a=f.data("min-val");var h=f.data("pace");if(!h){h=1}else{h=parseFloat(h)}var d=f.val();if(d!==undefined){d=parseFloat(d);d-=h;if((a!==undefined)&&(d<a)){d=a}}else{d=(b!==undefined)?b:0}d=number_format(d,2);f.val(d);f.trigger("onMouseHold",[g,d])})}jQuery.fn.mousehold=function(c,b){if(c&&(typeof(c)==="function")){b=c;c=100}if(b&&(typeof(b)==="function")){var d=0;var a=0;return this.each(function(){jQuery(this).mousedown(function(){a=1;var f=0;var e=this;d=setInterval(function(){f++;b.call(e,f);a=2},c)});clearMousehold=function(){clearInterval(d);if(a===1){b.call(this,1)}a=0};jQuery(this).mouseout(clearMousehold);jQuery(this).mouseup(clearMousehold)})}};jQuery(document).ready(function(){if(jQuery(".search-input")[0]){jQuery("body").on("focus",".search-input input",function(){jQuery(this).closest(".search-input").addClass("toggled")});jQuery("body").on("blur",".search-input input",function(){var b=jQuery(this).closest(".search-input");var a=jQuery(this).val();if(a.length===0){jQuery(this).closest(".search-input").removeClass("toggled")}})}});